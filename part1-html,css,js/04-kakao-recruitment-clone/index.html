<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./index.css" />
    <title>Fast Bank</title>
  </head>
  <body>
    <div id="main-img-wrapper">
      <img width="320" src="./Lovepik_com-401339128-data-management-data-analysis-icon-free-vector-illustration-mate.png" alt="coding image" />
    </div>
    <div id="intro-main">
      <p>ì´ë¯¸ ëª¨ë‘ì˜ ì€í–‰, íŒ¨ìŠ¤íŠ¸ë±…í¬</p>
      <p>í•¨ê»˜ ì¼í•´ìš”</p>
      <p id="join-us-text">join us!</p>
      <img id="down-arrow-icon" src="./down-arrow.png" alt="down arrow icon" />
    </div>
    <ul id="list-item-wrapper">
      <li class="list-item">26ì£¼ì ê¸ˆ</li>
      <li class="list-item">ì €ê¸ˆ</li>
      <li class="list-item">íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤</li>
      <li class="list-item">ë–¡ë³¶ì´</li>
      <li class="list-item">ì¹˜í‚¨</li>
      <li class="list-item">ì¶•êµ¬</li>
      <li class="list-item">ì¶•êµ¬ì„ ìˆ˜</li>
      <li class="list-item">ë§ˆì´ë„ˆìŠ¤í†µì¥ëŒ€ì¶œ</li>
      <li class="list-item">26ì£¼ì ê¸ˆ</li>
      <li class="list-item">ì €ê¸ˆ</li>
      <li class="list-item">íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤</li>
      <li class="list-item">ë–¡ë³¶ì´</li>
      <li class="list-item">ì¹˜í‚¨</li>
      <li class="list-item">ì¶•êµ¬</li>
      <li class="list-item">ì¶•êµ¬ì„ ìˆ˜</li>
      <li class="list-item">ë§ˆì´ë„ˆìŠ¤í†µì¥ëŒ€ì¶œ</li>
      <li class="list-item">26ì£¼ì ê¸ˆ</li>
      <li class="list-item">ì €ê¸ˆ</li>
      <li class="list-item">íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤</li>
      <li class="list-item">ë–¡ë³¶ì´</li>
      <li class="list-item">ì¹˜í‚¨</li>
      <li class="list-item">ì¶•êµ¬</li>
      <li class="list-item">ì¶•êµ¬ì„ ìˆ˜</li>
      <li class="list-item">ë§ˆì´ë„ˆìŠ¤í†µì¥ëŒ€ì¶œ</li>
      <li class="list-item">26ì£¼ì ê¸ˆ</li>
      <li class="list-item">ì €ê¸ˆ</li>
      <li class="list-item">íŒ¨ìŠ¤íŠ¸ìº í¼ìŠ¤</li>
      <li class="list-item">ë–¡ë³¶ì´</li>
      <li class="list-item">ì¹˜í‚¨</li>
      <li class="list-item">ì¶•êµ¬</li>
      <li class="list-item">ì¶•êµ¬ì„ ìˆ˜</li>
      <li class="list-item">ë§ˆì´ë„ˆìŠ¤í†µì¥ëŒ€ì¶œ</li>
    </ul>
    <main>
      <section id="panel1-img">
        <img id="flying-santa-image" src="./santa_flying.png" alt="santa flying" />
      </section>
      <section id="video-section">
        <div id="fixed-wrapper">
          <video id="video" src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4" type="video/mp4" muted loop></video>
          <div id="fixed-description">
            <div>í˜ì‹ ì´ ë§Œë“ </div>
            <div>ì••ë„ì ì¸ ì„±ì¥</div>
          </div>
        </div>
      </section>
      <div id="bank-beyond-wrapper">
        <div id="bank-beyond">
          <img src="./05-text.png" alt="sample text" />
        </div>
      </div>
      <div id="white-wrapper">
        <div id="slider-container">
          <div id="slider-content-wrapper">
            <div id="slider-content">
              <img src="https://picsum.photos/id/1/600/933" class="slider-image" alt="" />
              <img src="https://picsum.photos/id/59/600/933" class="slider-image" alt="" />
              <img src="https://picsum.photos/id/89/600/933" class="slider-image" alt="" />
            </div>
            <div class="slider-button" id="left-button">&lt;</div>
            <div class="slider-button" id="right-button">&gt;</div>
            <div id="slider-index">1/3</div>
          </div>
        </div>
      </div>
    </main>
  </body>
  <script>
    const listStyleChangeStartY = 373;
    const listStyleChangeEndY = 1585;

    const listItems = document.querySelectorAll(".list-item");

    // ì§€ì •í•œ ìŠ¤í¬ë¡¤ ì•ˆì—ì„œ ë°”ë€Œì–´ì•¼í•˜ëŠ” ë°°ì—´ì˜ ìš”ì†Œ ìˆ˜ ë§Œí¼ ë‚˜ëˆ„ì–´ì§€ëŠ” ìˆ˜ë¥¼ ë³€ìˆ˜ì— í• ë‹¹
    const division = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length;

    const panel1Img = document.getElementById("panel1-img");
    const flyingSantaImage = document.getElementById("flying-santa-image");

    // ìŠ¤í¬ë¡¤ ì–‘ì— ë”°ë¥¸ ë¹„ë””ì˜¤ ì¬ìƒ ìœ„ì¹˜ë¥¼ ì œì–´í•˜ëŠ” ë³€ìˆ˜
    // ê°’â¬†ï¸ == ë¹„ë””ì˜¤ì¬ìƒì†ë„â¬‡ï¸, ìŠ¤í¬ë¡¤ì–‘â¬†ï¸
    // ê°’â¬‡ï¸ == ë¹„ë””ì˜¤ì¬ìƒì†ë„â¬†ï¸, ìŠ¤í¬ë¡¤ì–‘â¬‡
    const videoPlayBack = 500;

    const videoElement = document.getElementById("video");
    const videoSection = document.getElementById("video-section");

    const fixedWrapper = document.getElementById("fixed-wrapper");

    const fixedDescription = document.getElementById("fixed-description");

    function centerElement(elementId, video) {
      const element = document.getElementById(elementId);
      const parent = element.parentElement;

      // ì§€ì •í•œ ìš”ì†Œ(fixed-wrapper)ê°€ í˜„ì¬ ë·°í¬íŠ¸ì˜ ì¤‘ì•™ì— ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¡œì§
      // ifë¬¸ì´ ì‹¤í–‰ë˜ë©´ í•´ë‹¹ ìš”ì†Œë¥¼ í™”ë©´ ê°€ìš´ë°ì— ê³ ì •
      // ì›í•˜ëŠ” ì¡°ê±´ì—ì„œ ë²—ì–´ë‚˜ë©´ ì›ë˜ëŒ€ë¡œ ì´ˆê¸°í™”
      if (window.scrollY > parent.offsetTop - (document.documentElement.clientHeight - element.offsetHeight) / 2) {
        element.style.position = "fixed";
        element.style.top = "50%";
        element.style.left = "50%";
        element.style.transform = "translate(-50%, -50%)";
        if (video) {
          video.currentTime = (window.scrollY - videoSection.offsetTop) / videoPlayBack;
        }
      } else {
        element.style.position = "relative";
        element.style.top = "initial";
        element.style.left = "initial";
        element.style.transform = "initial";
      }
    }

    // ë¹„ë””ì˜¤ì˜ ê¸¸ì´ì™€ ì„ì˜ë¡œ ì§€ì •í•œ videoPlayBackì„ í•©ì³ video-sectionì˜ ë†’ì´ë¥¼ ì¡°ì ˆ
    videoElement.addEventListener("loadedmetadata", () => {
      document.getElementById("video-section").style.height = videoElement.duration * videoPlayBack + "px";
    });

    // console.logë¡œ ì ë‹¹í•œ ìœ„ì¹˜ë¥¼ ì°¾ì•„ì„œ ë„£ìŒ
    const fixedDescriptionAppearTiming = 3470;
    const fixedDescriptionAppearEnds = 3800;

    window.addEventListener("scroll", () => {
      // console.log(window.scrollY);

      if (document.getElementById("on")) {
        document.getElementById("on").removeAttribute("id");
      }
      if (window.scrollY > listStyleChangeStartY && window.scrollY < listStyleChangeEndY) {
        // scrollYì—ì„œ ìš”ì†Œì— ì ‘ê·¼í•  index ë½‘ê¸°
        const targetIndex = Math.floor((window.scrollY - listStyleChangeStartY) / division);

        listItems[targetIndex].id = "on";
      }

      // ğŸ¯ğŸ¯ ìŠ¤í¬ë¡¤ìœ„ì¹˜ + í˜„ì¬ë·°ë†’ì´ë¡œ í˜„ì¬ í™”ë©´ì—ì„œ ì „ì²´ì ì¸ ìœ„ì¹˜ë¥¼ ê³„ì‚°í•˜ëŠ” ì½”ë“œ
      const scrollYBottom = window.scrollY + document.documentElement.clientHeight;

      // offsetTop: í•´ë‹¹ ìš”ì†Œì˜ Yì¶• ìœ„ì¹˜ ê°’(ì „ì²´ë¬¸ì„œ ê¸°ì¤€)
      // offsetHeight: í•´ë‹¹ ìš”ì†Œì˜ ë†’ì´ ê°’
      // ğŸ¯ğŸ¯
      // í˜„ì¬ìŠ¤í¬ë¡¤í•˜ë‹¨ìœ„ì¹˜ > panel1Imgì˜Yìœ„ì¹˜ && í˜„ì¬ìŠ¤í¬ë¡¤í•˜ë‹¨ìœ„ì¹˜ < panel1Imgì˜Yìœ„ì¹˜ + panel1Imgì˜ë†’ì´
      //  -> ìŠ¤í¬ë¡¤ì´ panel1Imgì— ì§„ì…í•˜ê±°ë‚˜, ìŠ¤í¬ë¡¤ì´ panel1Imgìš”ì†Œë¥¼ ë„˜ì–´ê°€ê¸° ì „ê¹Œì§€
      if (scrollYBottom > panel1Img.offsetTop && scrollYBottom < panel1Img.offsetTop + panel1Img.offsetHeight) {
        // CSSì—ì„œ ì´ˆê¸°ì— translateí•œ ê°’(80px, -13px, 23deg)ì„ ì›ë˜ëŒ€ë¡œ ëŒë¦°ë‹¤ëŠ” ëŠë‚Œìœ¼ë¡œ ë™ì‘
        // ğŸ¯ì›ë˜ëŒ€ë¡œ == translateê°€ ì ìš©ì•ˆëœ 0 ìƒíƒœ
        // ğŸ¯1.3ì€ ì›ë˜ ìœ„ì¹˜ì¸ 1.0ë³´ë‹¤ 0.3 ì¦‰ 30 í¼ì„¼íŠ¸ ë” ì´ë™í•˜ë¼ëŠ” ëœ»
        const translateX = 80 - (80 * 1.3 * (scrollYBottom - panel1Img.offsetTop)) / panel1Img.offsetHeight;
        const translateY = -13 + (13 * (scrollYBottom - panel1Img.offsetTop)) / panel1Img.offsetHeight;

        const rotationDegree = 23 - (23 * 1.7 * (scrollYBottom - panel1Img.offsetTop)) / panel1Img.offsetHeight;

        flyingSantaImage.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotationDegree}deg)`;
      }

      centerElement("fixed-wrapper", videoElement);

      // centerElementì˜ í™”ë©´ ì¤‘ì•™ì„ íƒì§€í•˜ëŠ” ë¡œì§ì²˜ëŸ¼ í™”ë©´ ì¤‘ì•™ì´ videoSectionì˜ ëì— ë„ë‹¬í•˜ëŠ”ì§€ í™•ì¸
      // ìì—°ìŠ¤ëŸ½ê²Œ ì• ë‹ˆë©”ì´ì…˜ í•´ì œ
      if (
        window.scrollY >
        videoSection.offsetTop + videoSection.offsetHeight - (fixedWrapper.offsetHeight + (document.documentElement.clientHeight - fixedWrapper.offsetHeight) / 2)
      ) {
        fixedWrapper.style.position = "relative";
        fixedWrapper.style.top = "initial";
        fixedWrapper.style.left = "initial";
        fixedWrapper.style.transform = "initial";
        fixedWrapper.style.transform = `translateY(${videoSection.offsetHeight - fixedWrapper.offsetHeight}px)`;
      }

      // fixedDescriptionAppearTimingê³¼ fixedDescriptionAppearEnds ì‚¬ì´ì¼ë•Œ ì‹¤í–‰ë˜ëŠ” ë¡œì§
      // ìš”ì†Œë¥¼ ì„œì„œíˆ ì˜¬ë¦¬ë©´ì„œ
      if (window.scrollY > fixedDescriptionAppearTiming && window.scrollY < fixedDescriptionAppearEnds) {
        fixedDescription.style.transform = `translateY(${fixedDescriptionAppearEnds - window.scrollY}px)`;

        // ìˆ«ìê°€ ì‘ì„ìˆ˜ë¡ ì„œì„œíˆ ë³€í™”
        fixedDescription.style.opacity = (window.scrollY - fixedDescriptionAppearTiming) / 300;
        // ê¸€ìê°€ ë‚˜íƒ€ë‚˜ëŠ” ì´ë²¤íŠ¸ê°€ ëë‚¬ì„ë•Œ ì ìš©(fixedDescriptionAppearEndsë³´ë‹¤ í˜„ì¬ ìœ„ì¹˜ê°€ ë” í´ë•Œ)
      } else if (window.scrollY > fixedDescriptionAppearEnds) {
        fixedDescription.style.transform = `translateY(0px)`;
        fixedDescription.style.opacity = 1;
        // ê·¸ ì™¸ì—ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ íˆ¬ëª…í•˜ê²Œ ìœ ì§€
      } else {
        fixedDescription.style.transform = `translateY(100px)`;
        fixedDescription.style.opacity = 0;
      }

      centerElement("bank-beyond");
    });

    let currentImage = 0;

    const sliderContentWrapper = document.getElementById("slider-content-wrapper");
    const sliderImages = document.querySelectorAll(".slider-image");

    const sliderIndex = document.getElementById("slider-index");

    const handleSlideChange = (step) => {
      currentImage += step;

      if (currentImage < 0) {
        currentImage = sliderImages.length - 1;
      } else if (currentImage >= sliderImages.length) {
        currentImage = 0;
      }

      // ğŸ¯ğŸ§°offsetLeftë¡œ íŠ¹ì •ì´ë¯¸ì§€ê°€ ë¶€ëª¨ìš”ì†Œì—ì„œ ë–¨ì–´ì§„ ê±°ë¦¬ë¥¼ êµ¬í•˜ê³  í•´ë‹¹ ê±°ë¦¬ë§Œí¼ ìŠ¤í¬ë¡¤ì„ ì‘ë™ ì‹œí‚´
      // ì´ë¯¸ì§€ ê°œìˆ˜ì— ìƒê´€ì—†ì´ ìŠ¤í¬ë¡¤ì„ í•´ì¤„ìˆ˜ ìˆìŒ
      sliderContentWrapper.scrollLeft = sliderImages[currentImage].offsetLeft;
    };

    document.getElementById("left-button").addEventListener("click", () => {
      handleSlideChange(-1);
    });
    document.getElementById("right-button").addEventListener("click", () => {
      handleSlideChange(1);
    });

    sliderContentWrapper.addEventListener("scroll", () => {
      const imageWidth = document.querySelectorAll(".slider-image")[0].offsetWidth;

      currentImage = Math.round(sliderContentWrapper.scrollLeft / imageWidth);
      sliderIndex.innerText = `${currentImage + 1} / ${sliderImages.length}`;
    });
  </script>
</html>
